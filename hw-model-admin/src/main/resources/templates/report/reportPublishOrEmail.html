<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org"
      xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<meta charset="utf-8">
<head th:include="include :: header"></head>
<link th:href="@{/ajax/libs/jquery-layout/jquery.layout-latest.css}" rel="stylesheet"/>
<link th:href="@{/ajax/libs/jquery-ztree/3.5/css/metro/zTreeStyle.css}" rel="stylesheet"/>
<body class="gray-bg">
<div class="container-div ui-layout-center">
    <div class="row">
       <iframe id="myFrame" src="" width="100%" height="100%" frameborder="0" scrolling="auto"></iframe>
    </div>
</div>

<div style="float: bottom;margin-bottom: 10px;text-align: center;">
    <button class="btn btn-danger" onclick="reportPublishOrEmail()">退出</button>
</div>
<div th:include="include :: footer"></div>
<script th:src="@{/ajax/libs/jquery-layout/jquery.layout-latest.js}"></script>

<script th:inline="javascript">
    var reportId = [[${reportId}]];
    var entReportName = [[${entReportName}]];
    var token = [[${token}]];
    var from = [[${from}]];
    var enterpriseId = [[${enterpriseId}]];
    var saasUrl = [[${saasUrl}]];

    $(function () {
        if ("email" == from) {
            parent.document.title = entReportName;
            document.getElementById("myFrame").src = saasUrl + "/report?reportName=" + entReportName + "&&reportId=" + reportId + "&&token=" + token + "&&from=" + from + "&&enterpriseId=" + enterpriseId;
        } else {
            document.getElementById("myFrame").src = saasUrl + "/report?reportName=" + entReportName + "&&reportId=" + reportId + "&&token=" + token + "&&from=" + from;
        }
    });

    function reportPublishOrEmail() {
        if ("send" == from) {
            var topWindow = $(window.parent.document);
            var currentId = $('.page-tabs-content', topWindow).find('.active').attr('data-panel');
            var $contentWindow = $('.RuoYi_iframe[data-id="' + currentId + '"]', topWindow)[0].contentWindow;
            $.modal.close();
            $contentWindow.$(".layui-layer-padding").removeAttr("style");
            if ($contentWindow.$.table._option.type == table_type.bootstrapTable) {
                $contentWindow.$.table.refresh();
            }
        } else {
            parent.document.title = "随行付管理系统首页";
        }
        closeItem();
    }

</script>
</body>
</html>
